network_def {
    convolutions {
        num_filters: 32
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 1
    }

    convolutions {
        num_filters: 64
        kernel_h: 3
        kernel_w: 3
        stride_h: 2
        stride_w: 2
        activation_function: LEAKY
        id: 2
    }

    residuals {
        id: 3
        input_id: 2
        multiplier: 1
        bare_convs {    
            num_filters: 32
            kernel_h: 1
            kernel_w: 1
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 1
        }
        bare_convs {
            num_filters: 64
            kernel_h: 3
            kernel_w: 3
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 2
        }
    }

    convolutions {
        num_filters: 128
        kernel_h: 3
        kernel_w: 3
        stride_h: 2
        stride_w: 2
        activation_function: LEAKY
        id: 4
    }

    residuals {
        id: 5
        input_id: 4
        multiplier: 2
        bare_convs {    
            num_filters: 64
            kernel_h: 1
            kernel_w: 1
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 1
        }
        bare_convs {
            num_filters: 128
            kernel_h: 3
            kernel_w: 3
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 2
        }
    }

    convolutions {
        num_filters: 256
        kernel_h: 3
        kernel_w: 3
        stride_h: 2
        stride_w: 2
        activation_function: LEAKY
        id: 6
    }

    residuals {
        id: 7
        input_id: 6
        multiplier: 8
        bare_convs {    
            num_filters: 128
            kernel_h: 1
            kernel_w: 1
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 1
        }
        bare_convs {
            num_filters: 256
            kernel_h: 3
            kernel_w: 3
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 2
        }
    }


    convolutions {
        num_filters: 512
        kernel_h: 3
        kernel_w: 3
        stride_h: 2
        stride_w: 2
        activation_function: LEAKY
        id: 8
    }

    residuals {
        id: 9
        input_id: 8
        multiplier: 8
        bare_convs {    
            num_filters: 256
            kernel_h: 1
            kernel_w: 1
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 1
        }
        bare_convs {
            num_filters: 512
            kernel_h: 3
            kernel_w: 3
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 2
        }
    }

    convolutions {
        num_filters: 1024
        kernel_h: 3
        kernel_w: 3
        stride_h: 2
        stride_w: 2
        activation_function: LEAKY
        id: 10
    }

    residuals {
        id: 11
        input_id: 10
        multiplier: 4
        bare_convs {    
            num_filters: 512
            kernel_h: 1
            kernel_w: 1
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 1
        }
        bare_convs {
            num_filters: 1024
            kernel_h: 3
            kernel_w: 3
            stride_h: 1
            stride_w: 1
            activation_function: LEAKY
            id: 2
        }
    }

    convolutions {
        num_filters: 512
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 12
    }

    convolutions {
        num_filters: 1024
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 13
    }

    convolutions {
        num_filters: 512
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 14
    }

    convolutions {
        num_filters: 1024
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 15
    }

    convolutions {
        num_filters: 512
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 16
    }

    convolutions {
        num_filters: 1024
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 17
    }

    yolos {
        anchors: [116, 90, 156, 198, 373, 326]
        num_classes: 1
        num: 3
        jitter: 0.3 
        ignore_threshold: 0.7
        truth_threshold: 1.0
        random: 1
        id: 18
    }

    convolutions {
        num_filters: 256
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 19
        input_id: 16
    }

    upsampling {
        factor: 2
        id: 20
    }

    routes {
        indices: [20, 9]
        id: 21
    }

    convolutions {
        num_filters: 256
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 22
    }

    convolutions {
        num_filters: 512
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 23
    }

    convolutions {
        num_filters: 256
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 24
    }

    convolutions {
        num_filters: 512
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 25
    }

    convolutions {
        num_filters: 256
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 26
    }

    convolutions {
        num_filters: 512
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 27
    }

    yolos {
        anchors: [30, 61, 62, 45, 59, 119]
        num_classes: 1
        num: 3
        jitter: 0.3
        ignore_threshold: 0.7
        truth_threshold: 1.0
        random: 1
        id: 28
    }

    convolutions {
        num_filters: 128
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 29 
        input_id: 26
    }

    upsampling {
        factor: 2
        id: 30
    }

    routes {
        indices: [30, 7]
        id: 31
    }

    convolutions {
        num_filters: 128
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 32
    }

    convolutions {
        num_filters: 256
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 33
    }

    convolutions {
        num_filters: 128
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 34
    }

    convolutions {
        num_filters: 256
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 35
    }

    convolutions {
        num_filters: 128
        kernel_h: 1
        kernel_w: 1
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 36
    }

    convolutions {
        num_filters: 256
        kernel_h: 3
        kernel_w: 3
        stride_h: 1
        stride_w: 1
        activation_function: LEAKY
        id: 37
    }

    yolos {
        anchors: [10, 13, 16, 30, 33, 32]
        num_classes: 1
        num: 3
        jitter: 0.3
        ignore_threshold: 0.7
        truth_threshold: 1.0
        random: 1
        id: 38
    }
}

train_config {
    dataset: "data/sample/train.record"
    epochs: 50
    batch_size: 2
    optimizer_config {
        sgd_optimizer {
        }
        exponential_decay {
            initial_learning_rate: 0.003
            decay_steps: 30
            decay_rate: 0.85
            staircase: true
        }
    }
    log: "training_logs/"
}

model_specs {
    image_height: 416
    image_width: 416
    num_classes: 1
}

eval_config {
    dataset: "data/sample/validation.record"
    batch_size: 2
    num_examples_visualize: 10
}

class_def {
    class_map {
        class_name: "Dog"
        class_id: 1
    }
}
